(function(){"use strict";var t={3354:function(t,e,n){t.exports=n.p+"img/球.952dc246.svg"},4062:function(t,e,n){t.exports=n.p+"img/横线.223a7928.svg"},8533:function(t,e,n){t.exports=n.p+"img/文字.347e3a95.svg"},9320:function(t,e,n){var i=n(5130),s=n(6768);const o={id:"app"};function r(t,e,n,i,r,a){const l=(0,s.g2)("PromptModal");return(0,s.uX)(),(0,s.CE)("div",o,[((0,s.uX)(),(0,s.Wv)((0,s.$y)(r.currentPage))),(0,s.bF)(l,{visible:r.showPromptModal,"onUpdate:visible":e[0]||(e[0]=t=>r.showPromptModal=t),closable:!1,onConfirm:a.handlePromptConfirm,onToggleMusic:a.handleMusicToggle},null,8,["visible","onConfirm","onToggleMusic"])])}n(4114),n(8111),n(2489),n(7588);var a=n(8533),l=n(4062),c=n(3354);const u={class:"home-page"},h={class:"content",ref:"contentBox"},d={class:"text-container"},m={class:"sliding-text",ref:"slidingText"},g={class:"horizontal-line",ref:"horizontalLine"},f={src:c,alt:"globe",class:"globe-svg",ref:"globeSvg",draggable:"false"};function v(t,e,n,o,r,c){return(0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("div",h,[(0,s.Lk)("div",d,[(0,s.Lk)("div",m,e[10]||(e[10]=[(0,s.Lk)("img",{src:a,alt:"ORTHYMOS",class:"text-svg"},null,-1)]),512),(0,s.Lk)("div",g,e[11]||(e[11]=[(0,s.Lk)("img",{src:l,alt:"line",class:"line-svg"},null,-1)]),512),(0,s.Lk)("div",{class:"globe-container",ref:"globeContainer",onMousedown:e[0]||(e[0]=(...t)=>c.startRotate&&c.startRotate(...t)),onMousemove:e[1]||(e[1]=(...t)=>c.rotateGlobe&&c.rotateGlobe(...t)),onMouseup:e[2]||(e[2]=(...t)=>c.endRotate&&c.endRotate(...t)),onMouseleave:e[3]||(e[3]=(...t)=>c.endRotate&&c.endRotate(...t)),onTouchstart:e[4]||(e[4]=(...t)=>c.startTouchRotate&&c.startTouchRotate(...t)),onTouchmove:e[5]||(e[5]=(...t)=>c.touchRotateGlobe&&c.touchRotateGlobe(...t)),onTouchend:e[6]||(e[6]=(...t)=>c.endTouchRotate&&c.endTouchRotate(...t)),onTouchcancel:e[7]||(e[7]=(...t)=>c.endTouchRotate&&c.endTouchRotate(...t)),onDragstart:e[8]||(e[8]=(0,i.D$)(()=>{},["prevent"])),onSelectstart:e[9]||(e[9]=(0,i.D$)(()=>{},["prevent"]))},[(0,s.Lk)("img",f,null,512)],544)])],512)])}var p={name:"HomePage",data(){return{animationStarted:!1,textAnimationComplete:!1,waitForConfirmation:!0,isRotating:!1,lastMouseX:0,lastTouchX:0,rotationSpeed:0,currentRotation:0,inertiaInterval:null,inertiaDecay:.98,baseRotationSpeed:18,sensitivityFactor:.8,touchSensitivityFactor:1.2,maxRotationSpeed:12,transitionThreshold:10,isTransitioning:!1,transitionStarted:!1,transitionDuration:1800}},mounted(){this.preloadSvg(),this.initPage(),window.addEventListener("resize",this.handleResize),document.addEventListener("dragstart",this.preventDrag),z.on("startHomeAnimation",this.handleStartAnimation)},beforeUnmount(){window.removeEventListener("resize",this.handleResize),document.removeEventListener("dragstart",this.preventDrag),this.inertiaInterval&&clearInterval(this.inertiaInterval),z.off("startHomeAnimation",this.handleStartAnimation)},methods:{handleStartAnimation(){this.waitForConfirmation=!1,setTimeout(()=>{this.startAnimation()},300)},preventDrag(t){t.preventDefault()},preloadSvg(){const t=new Image;t.src=n(8533);const e=new Image;e.src=n(4062);const i=new Image;i.src=n(3354)},initPage(){this.handleResize()},handleResize(){},startAnimation(){if(this.animationStarted||this.waitForConfirmation)return;this.animationStarted=!0;const t=this.$refs.slidingText,e=this.$refs.contentBox,n=this.$refs.horizontalLine,i=this.$refs.globeContainer;requestAnimationFrame(()=>{e.classList.add("show"),setTimeout(()=>{t.classList.add("animate"),setTimeout(()=>{n.classList.add("animate"),setTimeout(()=>{i.classList.add("animate")},800)},800)},600)}),setTimeout(()=>{this.textAnimationComplete=!0},3200)},startRotate(t){if(!this.textAnimationComplete||this.isTransitioning)return;t.preventDefault(),document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",document.body.style.mozUserSelect="none",document.body.style.msUserSelect="none",this.isRotating=!0,this.lastMouseX=t.clientX,this.inertiaInterval&&(clearInterval(this.inertiaInterval),this.inertiaInterval=null);const e=this.$refs.globeSvg;if(e){const t=window.getComputedStyle(e);let i;try{if(window.DOMMatrix)i=new DOMMatrix(t.transform);else{if(!window.WebKitCSSMatrix)return this.currentRotation=0,e.style.animation="none",void(e.style.transform=`rotate(${this.currentRotation}deg)`);i=new WebKitCSSMatrix(t.transform)}this.currentRotation=Math.atan2(i.b,i.a)*(180/Math.PI)}catch(n){console.warn("无法获取当前旋转角度:",n),this.currentRotation=0}e.style.animation="none",e.style.transform=`rotate(${this.currentRotation}deg)`}},rotateGlobe(t){if(!this.isRotating||this.isTransitioning)return;t.preventDefault();const e=t.clientX-this.lastMouseX;if(this.lastMouseX=t.clientX,e>0){if(this.rotationSpeed=Math.min(e*this.sensitivityFactor,this.maxRotationSpeed),this.rotationSpeed>this.transitionThreshold&&!this.transitionStarted)return void this.startPageTransition();this.currentRotation+=this.rotationSpeed;const t=this.$refs.globeSvg;t&&(t.style.transform=`rotate(${this.currentRotation}deg)`)}},endRotate(){this.isRotating&&!this.isTransitioning&&(this.isRotating=!1,document.body.style.userSelect="",document.body.style.webkitUserSelect="",document.body.style.mozUserSelect="",document.body.style.msUserSelect="",this.rotationSpeed>this.transitionThreshold&&!this.transitionStarted?this.startPageTransition():Math.abs(this.rotationSpeed)>.1?this.startInertia():this.resetOriginalAnimation())},startInertia(){this.inertiaInterval&&clearInterval(this.inertiaInterval),this.inertiaInterval=setInterval(()=>{if(this.rotationSpeed*=this.inertiaDecay,this.rotationSpeed>this.transitionThreshold&&!this.transitionStarted)return clearInterval(this.inertiaInterval),this.inertiaInterval=null,void this.startPageTransition();if(this.rotationSpeed>0){this.currentRotation+=this.rotationSpeed;const t=this.$refs.globeSvg;t&&(t.style.transform=`rotate(${this.currentRotation}deg)`)}Math.abs(this.rotationSpeed)<.1&&(clearInterval(this.inertiaInterval),this.inertiaInterval=null,this.resetOriginalAnimation())},16)},resetOriginalAnimation(){const t=this.$refs.globeSvg;if(t){const e=(this.currentRotation%360+360)%360,n=`\n          @keyframes resumeRotate {\n            0% { transform: rotate(${e}deg); }\n            100% { transform: rotate(${e+360}deg); }\n          }\n        `,i=document.createElement("style");i.type="text/css",i.innerText=n,document.head.appendChild(i),t.style.animation=`resumeRotate ${this.baseRotationSpeed}s linear infinite`}},startPageTransition(){if(this.transitionStarted)return;this.transitionStarted=!0,this.isTransitioning=!0,this.inertiaInterval&&(clearInterval(this.inertiaInterval),this.inertiaInterval=null);const t=this.$refs.slidingText,e=this.$refs.horizontalLine,n=this.$refs.globeContainer,i=this.$refs.contentBox,s=this.$refs.globeSvg;if(s){const t=(this.currentRotation%360+360)%360,e=`\n          @keyframes transitionRotate {\n            0% { transform: rotate(${t}deg); }\n            100% { transform: rotate(${t+720}deg); }\n          }\n        `,n=document.createElement("style");n.type="text/css",n.innerText=e,document.head.appendChild(n),s.style.animation=`transitionRotate ${this.transitionDuration/1e3}s linear forwards`}i.classList.add("splitting"),t.classList.add("split-up"),e.classList.add("split-up"),n.classList.add("split-down"),setTimeout(()=>{this.$root.switchPage("MainPage")},this.transitionDuration)},startTouchRotate(t){if(!this.textAnimationComplete||this.isTransitioning)return;t.preventDefault(),this.isRotating=!0,this.lastTouchX=t.touches[0].clientX,this.inertiaInterval&&(clearInterval(this.inertiaInterval),this.inertiaInterval=null);const e=this.$refs.globeSvg;if(e){const t=window.getComputedStyle(e);let i;try{if(window.DOMMatrix)i=new DOMMatrix(t.transform);else{if(!window.WebKitCSSMatrix)return this.currentRotation=0,e.style.animation="none",void(e.style.transform=`rotate(${this.currentRotation}deg)`);i=new WebKitCSSMatrix(t.transform)}this.currentRotation=Math.atan2(i.b,i.a)*(180/Math.PI)}catch(n){console.warn("无法获取当前旋转角度:",n),this.currentRotation=0}e.style.animation="none",e.style.transform=`rotate(${this.currentRotation}deg)`}},touchRotateGlobe(t){if(!this.isRotating||this.isTransitioning)return;t.preventDefault();const e=t.touches[0].clientX,n=e-this.lastTouchX;if(this.lastTouchX=e,n>0){if(this.rotationSpeed=Math.min(n*this.touchSensitivityFactor,this.maxRotationSpeed),this.rotationSpeed>this.transitionThreshold&&!this.transitionStarted)return void this.startPageTransition();this.currentRotation+=this.rotationSpeed;const t=this.$refs.globeSvg;t&&(t.style.transform=`rotate(${this.currentRotation}deg)`)}},endTouchRotate(){this.isRotating&&!this.isTransitioning&&(this.isRotating=!1,this.rotationSpeed>this.transitionThreshold&&!this.transitionStarted?this.startPageTransition():Math.abs(this.rotationSpeed)>.1?this.startInertia():this.resetOriginalAnimation())}}},b=n(1241);const S=(0,b.A)(p,[["render",v],["__scopeId","data-v-545eb2c8"]]);var R=S;const F={class:"main-page"};function y(t,e,n,i,o,r){return(0,s.uX)(),(0,s.CE)("div",F,e[0]||(e[0]=[(0,s.Lk)("div",{class:"content"},null,-1)]))}var w={name:"MainPage"};const C=(0,b.A)(w,[["render",y],["__scopeId","data-v-6ede290e"]]);var T=C,k=n(4232);const I={class:"prompt-modal"},L={class:"prompt-content"},M={class:"setting-item"},E={class:"setting-item"},x={class:"prompt-footer"};function $(t,e,n,o,r,a){return n.visible?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,k.C4)(["prompt-modal-container",{"fade-in":r.fadeIn}])},[(0,s.Lk)("div",{class:"overlay",onClick:e[0]||(e[0]=(0,i.D$)((...t)=>a.closeIfClickable&&a.closeIfClickable(...t),["self"]))}),(0,s.Lk)("div",I,[e[8]||(e[8]=(0,s.Lk)("div",{class:"prompt-header"},[(0,s.Lk)("h2",null,"温馨提示")],-1)),(0,s.Lk)("div",L,[(0,s.Lk)("div",M,[e[5]||(e[5]=(0,s.Lk)("span",{class:"setting-label"},"是否全屏显示",-1)),(0,s.Lk)("div",{class:(0,k.C4)(["toggle-switch",{active:r.isFullscreen}]),onClick:e[1]||(e[1]=(...t)=>a.toggleFullscreen&&a.toggleFullscreen(...t))},e[4]||(e[4]=[(0,s.Lk)("div",{class:"toggle-handle"},null,-1)]),2)]),(0,s.Lk)("div",E,[e[7]||(e[7]=(0,s.Lk)("span",{class:"setting-label"},"是否开启音乐",-1)),(0,s.Lk)("div",{class:(0,k.C4)(["toggle-switch",{active:r.musicEnabled}]),onClick:e[2]||(e[2]=(...t)=>a.toggleMusic&&a.toggleMusic(...t))},e[6]||(e[6]=[(0,s.Lk)("div",{class:"toggle-handle"},null,-1)]),2)])]),(0,s.Lk)("div",x,[(0,s.Lk)("button",{class:"confirm-button",onClick:e[3]||(e[3]=(...t)=>a.confirm&&a.confirm(...t))},"确认")])])],2)):(0,s.Q3)("",!0)}var P={name:"PromptModal",props:{visible:{type:Boolean,default:!0},closable:{type:Boolean,default:!0}},emits:["update:visible","confirm","toggle-music"],data(){return{isFullscreen:!1,musicEnabled:!1,fadeIn:!1}},watch:{visible(t){t?setTimeout(()=>{this.fadeIn=!0},50):this.fadeIn=!1}},mounted(){document.addEventListener("fullscreenchange",this.handleFullscreenChange),document.addEventListener("mozfullscreenchange",this.handleFullscreenChange),document.addEventListener("webkitfullscreenchange",this.handleFullscreenChange),document.addEventListener("msfullscreenchange",this.handleFullscreenChange),setTimeout(()=>{this.fadeIn=!0},50),window.addEventListener("beforeunload",this.handleBeforeUnload)},beforeUnmount(){document.removeEventListener("fullscreenchange",this.handleFullscreenChange),document.removeEventListener("mozfullscreenchange",this.handleFullscreenChange),document.removeEventListener("webkitfullscreenchange",this.handleFullscreenChange),document.removeEventListener("msfullscreenchange",this.handleFullscreenChange),window.removeEventListener("beforeunload",this.handleBeforeUnload)},methods:{toggleFullscreen(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.enterFullscreen():this.exitFullscreen()},toggleMusic(){this.musicEnabled=!this.musicEnabled,this.$emit("toggle-music",this.musicEnabled)},confirm(){this.fadeIn=!1,setTimeout(()=>{this.$emit("confirm",{fullscreen:this.isFullscreen,music:this.musicEnabled}),this.$emit("update:visible",!1)},300)},closeIfClickable(){this.closable&&(this.fadeIn=!1,setTimeout(()=>{this.$emit("update:visible",!1)},300))},enterFullscreen(){const t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},checkFullscreen(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},handleFullscreenChange(){this.isFullscreen=this.checkFullscreen()},handleBeforeUnload(){localStorage.setItem("appSettings",JSON.stringify({fullscreen:this.isFullscreen,music:this.musicEnabled}))}}};const O=(0,b.A)(P,[["render",$],["__scopeId","data-v-309eadcb"]]);var A=O;const z={events:{},emit(t,e){this.events[t]&&this.events[t].forEach(t=>t(e))},on(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},off(t,e){this.events[t]&&(this.events[t]=this.events[t].filter(t=>t!==e))}};var D={name:"App",components:{HomePage:R,MainPage:T,PromptModal:A},data(){return{currentPage:"HomePage",showPromptModal:!0,settingsConfig:{fullscreen:!1,music:!1}}},mounted(){this.loadSavedSettings(),document.addEventListener("visibilitychange",this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},methods:{switchPage(t){this.currentPage=t},handlePromptConfirm(t){this.settingsConfig=t,this.showPromptModal=!1,this.saveSettings(),z.emit("startHomeAnimation")},handleMusicToggle(t){this.settingsConfig.music=t},handleVisibilityChange(){"visible"===document.visibilityState&&this.loadSavedSettings()},saveSettings(){localStorage.setItem("appSettings",JSON.stringify({fullscreen:this.settingsConfig.fullscreen,music:this.settingsConfig.music,welcomed:!0}))},loadSavedSettings(){try{const t=localStorage.getItem("appSettings");if(t){const e=JSON.parse(t);this.settingsConfig={fullscreen:e.fullscreen||!1,music:e.music||!1},e.welcomed&&(this.showPromptModal=!1,setTimeout(()=>{z.emit("startHomeAnimation")},100)),this.settingsConfig.fullscreen&&!this.isCurrentlyFullscreen()&&this.requestFullscreen()}}catch(t){console.error("加载设置时出错:",t)}},isCurrentlyFullscreen(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},requestFullscreen(){const t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}}};const q=(0,b.A)(D,[["render",r]]);var X=q;(0,i.Ef)(X).mount("#app")}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}n.m=t,function(){var t=[];n.O=function(e,i,s,o){if(!i){var r=1/0;for(u=0;u<t.length;u++){i=t[u][0],s=t[u][1],o=t[u][2];for(var a=!0,l=0;l<i.length;l++)(!1&o||r>=o)&&Object.keys(n.O).every(function(t){return n.O[t](i[l])})?i.splice(l--,1):(a=!1,o<r&&(r=o));if(a){t.splice(u--,1);var c=s();void 0!==c&&(e=c)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[i,s,o]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.p="/map/"}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,o,r=i[0],a=i[1],l=i[2],c=0;if(r.some(function(e){return 0!==t[e]})){for(s in a)n.o(a,s)&&(n.m[s]=a[s]);if(l)var u=l(n)}for(e&&e(i);c<r.length;c++)o=r[c],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(u)},i=self["webpackChunkmap"]=self["webpackChunkmap"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=n.O(void 0,[504],function(){return n(9320)});i=n.O(i)})();
//# sourceMappingURL=app.f100b887.js.map